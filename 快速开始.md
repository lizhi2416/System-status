# 快速开始指南

## 1. 安装依赖

**注意**：由于PySimpleGUI 4已从PyPI移除，我们使用社区维护的 `xl-gui` 包（兼容PySimpleGUI 4）。

```bash
pip install -r requirements.txt
```

或者手动安装：

```bash
pip install xl-gui==4.60.5 requests
```

**macOS用户注意**：如果遇到tkinter相关错误，请使用系统Python（`/usr/bin/python3`）而不是Homebrew安装的Python。

## 2. 运行GUI程序

### 方式一：使用启动脚本（推荐）

```bash
./run_gui.sh
```

或者使用tkinter版本：

```bash
./run_gui_tkinter.sh
```

### 方式二：直接运行（推荐使用Python 3.12）

**重要**：为了确保GUI正常显示，建议使用Python 3.12（Tk 9.0）：

```bash
python3.12 monitor_gui_tkinter.py
```

如果使用其他Python版本：

```bash
python3 monitor_gui_tkinter.py
```

**注意**：旧版Python（如Python 3.9）的tkinter可能无法正常显示GUI内容，建议使用Python 3.12或更高版本。

## 3. 配置说明

### 方式一：在GUI界面中配置（推荐）

1. 打开程序后，在界面中直接输入：
   - **检测间隔（分钟）**：例如 30（表示30分钟检测一次）
   - **失败重试次数**：例如 3（失败后重试3次）
   - **重试间隔（秒）**：例如 10（重试间隔10秒）
   - **收件人邮箱**：例如 your_email@example.com

2. 点击"开始监控"按钮

### 方式二：在config.py中配置

编辑 `config.py` 文件，修改以下配置：

```python
# 监控配置
CHECK_INTERVAL = 1800  # 检测间隔（秒），30分钟 = 1800秒
RETRY_COUNT = 3  # 请求失败重试次数
RETRY_DELAY = 10  # 重试间隔（秒）

# 邮件配置
EMAIL_CONFIG = {
    'smtp_server': 'smtp.sina.com',  # 你的SMTP服务器
    'smtp_port': 465,  # SMTP端口
    'use_ssl': True,  # 是否使用SSL
    'use_tls': False,  # 是否使用TLS
    'from_email': 'your_email@sina.com',  # 发件人邮箱
    'password': 'your_password',  # 邮箱密码或授权码
    'to_email': 'notify@example.com',  # 收件人邮箱（默认值）
}
```

**注意**：邮件配置中的发件人邮箱和密码必须在 `config.py` 中配置，GUI界面只能配置收件人邮箱。

## 4. 打包为桌面应用

### macOS/Linux

```bash
chmod +x build_app.sh
./build_app.sh
```

### Windows

双击运行 `build_app.bat`

打包完成后，可执行文件位于 `dist/` 目录下。

## 5. 常见问题

### Q: 提示"PySimpleGUI未安装"
A: 运行 `pip install PySimpleGUI==4.60.5`

### Q: 邮件发送失败
A: 检查 `config.py` 中的邮件配置：
- 确认SMTP服务器和端口正确
- 确认邮箱密码或授权码正确
- 确认已开启SMTP服务（部分邮箱需要手动开启）

### Q: 打包后的程序无法运行
A: 确保打包时包含了所有依赖，如果遇到问题，可以尝试：
- 使用 `--debug=all` 参数查看详细错误
- 检查是否有缺失的模块

### Q: GUI界面显示异常
A: 确保使用的是PySimpleGUI 4版本，不要使用PySimpleGUI 5（需要付费）

## 6. 功能说明

- **开始监控**：启动后台监控任务
- **停止监控**：停止正在运行的监控任务
- **清空日志**：清空日志显示区域
- **监控日志**：实时显示监控过程中的所有日志信息
- **状态栏**：显示当前监控状态和最后检查时间
